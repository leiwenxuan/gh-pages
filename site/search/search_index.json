{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Welcome to MkDocs For full documentation visit mkdocs.org . Commands mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message. Project layout mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Home"},{"location":"#welcome-to-mkdocs","text":"For full documentation visit mkdocs.org .","title":"Welcome to MkDocs"},{"location":"#commands","text":"mkdocs new [dir-name] - Create a new project. mkdocs serve - Start the live-reloading docs server. mkdocs build - Build the documentation site. mkdocs help - Print this help message.","title":"Commands"},{"location":"#project-layout","text":"mkdocs.yml # The configuration file. docs/ index.md # The documentation homepage. ... # Other markdown pages, images and other files.","title":"Project layout"},{"location":"RBAC/","text":"November 27, 2018 7:16 PM RBAC\u57fa\u7840\u4e0a\u5b9e\u73b0\u4e0d\u540c\u7684\u7528\u6237\u4e0d\u540c\u7684\u754c\u9762.md \u5b9e\u73b0\u4e0d\u540c\u7684\u7528\u6237\u4e0d\u540c\u7684\u754c\u9762 \u5728\u6743\u9650\u8868\u8bbe\u7f6e\u5b57\u6bb5\u533a\u5206\u4e0d\u540c\u7684\u6743\u9650 is_menu \u51b3\u5b9a\u8fd9\u4e2a\uff35\uff32\uff2c\u5728\u4e0d\u5728\u89c6\u56fe\u4e0a\u663e\u793a\u3000 # \u6743\u9650\u8868 class UserPurview(models.Model): title = models.CharField(max_length=32) url = models.CharField(max_length=80) is_menu = models.BooleanField(default=False, verbose_name='\u83dc\u5355') icon = models.CharField(max_length=24, null=True, blank=True, verbose_name='\u56fe\u6807') \u8bbe\u7f6esession \u67e5\u8be2\u8868\u6ce8\u610f\u53bb\u91cd QuerySet\u5bf9\u8c61.distinct() \u8fd9\u91cc\u628a\u8bbe\u7f6esession \u7684\u4ee3\u7801\u5c01\u88c5\u4e86\u5de5\u5177 \u628a\u76f8\u540c\u53ef\u4ee5\u5b9e\u73b0\u591a\u6b21\u7684\u8c03\u7528\u7684\u4ee3\u7801\u7247\u6bb5\u5b9e\u73b0\u5c01\u88c5\uff0c\u9762\u5bf9\u51fd\u6570\u7f16\u7a0b\uff0c\u9886\u609f\u9762\u5bf9\u5bf9\u8c61\u5f0f\u7f16\u7a0b ''' \u8bbe\u7f6esession\u3000\u6570\u636e ''' from SZcrm import settings def init(request, user_obj): # 1.\u67e5\u8be2\u7528\u6237\u6743\u9650 # 2.\u628a\u67e5\u8be2\u7684url \u6dfb\u52a0\u5230session \u91cc\u9762 url_list = user_obj.roles.all().values( 'permissions__url', 'permissions__title', 'permissions__is_menu', 'permissions__icon').distinct() # \u8fd4\u56de\u7684QuerySet\u5bf9\u8c61\uff0c\u6ca1\u4e2a\u5143\u7d20\u90fd\u662f\u5143\u7ec4 # 3.\u628a\u67e5\u8be2\u7684\uff55\uff52\uff4c\u52a0\u5165\u5217\u8868 # \u53d6\u5230url_list # permissions_list = [permissions['permissions__url'] for permissions in url_list] permissions_list = [] # \u5b58\u653e\u83dc\u5355\u5217\u8868 menu_list = [] for i in url_list: permissions_list.append(i['permissions__url']) if i.get('permissions__is_menu'): menu_list.append({ 'url': i['permissions__url'], 'title': i['permissions__title'], 'icon': i['permissions__icon'], }) session_key = getattr(settings, 'PERMISSION_URL_KEY', 'permissions_url') menu_key = getattr(settings, 'SECRET_MENU', 'menu_list') # \u8bbe\u7f6esession, \u5b58\u53d6menu\u5217\u8868 request.session[menu_key] = menu_list # \u8bbe\u7f6esession, \u5b58\u53d6\uff55\uff52\uff4c\u5217\u8868 request.session[session_key] = permissions_list \u524d\u7aef\u7684\u4ee3\u7801\u5b9e\u73b0 \u5728\u5199\u7a0b\u5e8f\u4e4b\u524d\u60f3\u60f3\u5982\u4f55\u89c4\u8303\u4ee3\u7801\u7684\u5065\u58ee\u578b\u3002 \u524d\u7aef\u63a5\u53d7\u6570\u636e\u4f9d\u8d56\u540e\u7aef\uff0c\u6709\u4e00\u4e9b\u53d8\u91cf\u6211\u4eec\u5199\u5728\u4e86\u914d\u7f6e\u6587\u4ef6\u91cc\u9762\uff0c\u3000\u9632\u6b62\u540e\u671f\u53d8\u52a8\uff0c\u5f71\u54cd\u6574\u4e2a\u9879\u76ee\u3002\u90a3\u4e48\u524d\u7aef\u5982\u4f55\u5b9e\u73b0\u5462 \u81ea\u5b9a\u4e49django \u6a21\u677f\u51fd\u6570\u3000inclusion_tag 1.\u5728\u5f53\u524d\u7684\uff41\uff50\uff50\u4e0b\u5efa\u7acbtemplatetags\u5305 2. from django import template register = template.Library() \u81ea\u5df1\u7684\u4e1a\u52a1\u903b\u8f91 \u4ee3\u7801\u5b9e\u73b0 from django import template from SZcrm import settings import re register = template.Library() @register.inclusion_tag(filename='rbac/menu.html') def meun_list(request): # \uff11\uff0e \u83b7\u53d6\u5f53\u524d\u7684url new_url = request.path_info # \uff12\uff0e \u83b7\u53d6session\u3000\u50a8\u5b58\u7684session\u3000key meun_key = getattr(settings, 'SECRET_MENU', 'menu_list') # 3. \u83b7\u53d6session \u91cc\u9762\u7684\u6743\u9650\u9650\u5b9a meun_list = request.session.get(meun_key) # 4.\u3000\u5faa\u73af\u5224\u65ad\uff1a\u5982\u679c\u5f53\u524d\u7684\uff55\uff52\uff4c\u5728\u6743\u9650\u91cc\u9762\u52a0\u4e00\u4e2acss\u6837\u5f0f\uff0c for meun in meun_list: if re.match(r'^{}$'.format(meun['url']), new_url): meun['class'] = 'active' return {'menu_list': meun_list} inclusion_tag html \u4ee3\u7801\u3000\u4e0e\u4e0d\u540c\u7684\u524d\u7aef\u4ee3\u7801\u65e0\u533a\u522b <ul class=\"nav nav-sidebar navbar-inverse\"> {% for menu in menu_list %} <li class=\"{{ menu.class }}\"><a href=\"{{ menu.url }}\"><span class=\"icon-wrap\"><i class=\"fa {{ menu.icon }}\"></i></span>{{ menu.title }}</a></li> {% endfor %} </ul> \u65f6\u523b\u6ce8\u610f\u6587\u4ef6\u8def\u5f84\u95ee\u9898\uff0c\u3000\u6570\u636e\u5e93\u5bfc\u5165\u3000\u6700\u4e3a\u91cd\u8981\u7684\u662f\u6284\u4ee3\u7801\u5355\u8bcd\u95ee\u9898","title":"Text"},{"location":"RBAC/#november-27-2018-716-pm","text":"","title":"November 27, 2018 7:16 PM"},{"location":"RBAC/#rbacmd","text":"","title":"RBAC\u57fa\u7840\u4e0a\u5b9e\u73b0\u4e0d\u540c\u7684\u7528\u6237\u4e0d\u540c\u7684\u754c\u9762.md"},{"location":"RBAC/#_1","text":"","title":"\u5b9e\u73b0\u4e0d\u540c\u7684\u7528\u6237\u4e0d\u540c\u7684\u754c\u9762"},{"location":"RBAC/#_2","text":"is_menu \u51b3\u5b9a\u8fd9\u4e2a\uff35\uff32\uff2c\u5728\u4e0d\u5728\u89c6\u56fe\u4e0a\u663e\u793a\u3000 # \u6743\u9650\u8868 class UserPurview(models.Model): title = models.CharField(max_length=32) url = models.CharField(max_length=80) is_menu = models.BooleanField(default=False, verbose_name='\u83dc\u5355') icon = models.CharField(max_length=24, null=True, blank=True, verbose_name='\u56fe\u6807')","title":"\u5728\u6743\u9650\u8868\u8bbe\u7f6e\u5b57\u6bb5\u533a\u5206\u4e0d\u540c\u7684\u6743\u9650"},{"location":"RBAC/#session","text":"\u67e5\u8be2\u8868\u6ce8\u610f\u53bb\u91cd","title":"\u8bbe\u7f6esession"},{"location":"RBAC/#querysetdistinct","text":"","title":"QuerySet\u5bf9\u8c61.distinct()"},{"location":"RBAC/#session_1","text":"","title":"\u8fd9\u91cc\u628a\u8bbe\u7f6esession \u7684\u4ee3\u7801\u5c01\u88c5\u4e86\u5de5\u5177"},{"location":"RBAC/#_3","text":"''' \u8bbe\u7f6esession\u3000\u6570\u636e ''' from SZcrm import settings def init(request, user_obj): # 1.\u67e5\u8be2\u7528\u6237\u6743\u9650 # 2.\u628a\u67e5\u8be2\u7684url \u6dfb\u52a0\u5230session \u91cc\u9762 url_list = user_obj.roles.all().values( 'permissions__url', 'permissions__title', 'permissions__is_menu', 'permissions__icon').distinct() # \u8fd4\u56de\u7684QuerySet\u5bf9\u8c61\uff0c\u6ca1\u4e2a\u5143\u7d20\u90fd\u662f\u5143\u7ec4 # 3.\u628a\u67e5\u8be2\u7684\uff55\uff52\uff4c\u52a0\u5165\u5217\u8868 # \u53d6\u5230url_list # permissions_list = [permissions['permissions__url'] for permissions in url_list] permissions_list = [] # \u5b58\u653e\u83dc\u5355\u5217\u8868 menu_list = [] for i in url_list: permissions_list.append(i['permissions__url']) if i.get('permissions__is_menu'): menu_list.append({ 'url': i['permissions__url'], 'title': i['permissions__title'], 'icon': i['permissions__icon'], }) session_key = getattr(settings, 'PERMISSION_URL_KEY', 'permissions_url') menu_key = getattr(settings, 'SECRET_MENU', 'menu_list') # \u8bbe\u7f6esession, \u5b58\u53d6menu\u5217\u8868 request.session[menu_key] = menu_list # \u8bbe\u7f6esession, \u5b58\u53d6\uff55\uff52\uff4c\u5217\u8868 request.session[session_key] = permissions_list","title":"\u628a\u76f8\u540c\u53ef\u4ee5\u5b9e\u73b0\u591a\u6b21\u7684\u8c03\u7528\u7684\u4ee3\u7801\u7247\u6bb5\u5b9e\u73b0\u5c01\u88c5\uff0c\u9762\u5bf9\u51fd\u6570\u7f16\u7a0b\uff0c\u9886\u609f\u9762\u5bf9\u5bf9\u8c61\u5f0f\u7f16\u7a0b"},{"location":"RBAC/#_4","text":"","title":"\u524d\u7aef\u7684\u4ee3\u7801\u5b9e\u73b0"},{"location":"RBAC/#_5","text":"\u524d\u7aef\u63a5\u53d7\u6570\u636e\u4f9d\u8d56\u540e\u7aef\uff0c\u6709\u4e00\u4e9b\u53d8\u91cf\u6211\u4eec\u5199\u5728\u4e86\u914d\u7f6e\u6587\u4ef6\u91cc\u9762\uff0c\u3000\u9632\u6b62\u540e\u671f\u53d8\u52a8\uff0c\u5f71\u54cd\u6574\u4e2a\u9879\u76ee\u3002\u90a3\u4e48\u524d\u7aef\u5982\u4f55\u5b9e\u73b0\u5462","title":"\u5728\u5199\u7a0b\u5e8f\u4e4b\u524d\u60f3\u60f3\u5982\u4f55\u89c4\u8303\u4ee3\u7801\u7684\u5065\u58ee\u578b\u3002"},{"location":"RBAC/#django-inclusion_tag","text":"1.\u5728\u5f53\u524d\u7684\uff41\uff50\uff50\u4e0b\u5efa\u7acbtemplatetags\u5305 2. from django import template register = template.Library() \u81ea\u5df1\u7684\u4e1a\u52a1\u903b\u8f91","title":"\u81ea\u5b9a\u4e49django \u6a21\u677f\u51fd\u6570\u3000inclusion_tag"},{"location":"RBAC/#_6","text":"from django import template from SZcrm import settings import re register = template.Library() @register.inclusion_tag(filename='rbac/menu.html') def meun_list(request): # \uff11\uff0e \u83b7\u53d6\u5f53\u524d\u7684url new_url = request.path_info # \uff12\uff0e \u83b7\u53d6session\u3000\u50a8\u5b58\u7684session\u3000key meun_key = getattr(settings, 'SECRET_MENU', 'menu_list') # 3. \u83b7\u53d6session \u91cc\u9762\u7684\u6743\u9650\u9650\u5b9a meun_list = request.session.get(meun_key) # 4.\u3000\u5faa\u73af\u5224\u65ad\uff1a\u5982\u679c\u5f53\u524d\u7684\uff55\uff52\uff4c\u5728\u6743\u9650\u91cc\u9762\u52a0\u4e00\u4e2acss\u6837\u5f0f\uff0c for meun in meun_list: if re.match(r'^{}$'.format(meun['url']), new_url): meun['class'] = 'active' return {'menu_list': meun_list}","title":"\u4ee3\u7801\u5b9e\u73b0"},{"location":"RBAC/#inclusion_tag-html","text":"<ul class=\"nav nav-sidebar navbar-inverse\"> {% for menu in menu_list %} <li class=\"{{ menu.class }}\"><a href=\"{{ menu.url }}\"><span class=\"icon-wrap\"><i class=\"fa {{ menu.icon }}\"></i></span>{{ menu.title }}</a></li> {% endfor %} </ul>","title":"inclusion_tag html \u4ee3\u7801\u3000\u4e0e\u4e0d\u540c\u7684\u524d\u7aef\u4ee3\u7801\u65e0\u533a\u522b"},{"location":"RBAC/#_7","text":"","title":"\u65f6\u523b\u6ce8\u610f\u6587\u4ef6\u8def\u5f84\u95ee\u9898\uff0c\u3000\u6570\u636e\u5e93\u5bfc\u5165\u3000\u6700\u4e3a\u91cd\u8981\u7684\u662f\u6284\u4ee3\u7801\u5355\u8bcd\u95ee\u9898"},{"location":"about/","text":"Et faciat texebas sororum locus volucres sanguine Sedit ferox Lorem markdownum ex postquam, Lelegas premebat, nefandam pedibusque fonte transitus cruentatis exclamat genus nil: structis inclusos postquam. Est videt. Tamen quod veram, torva tenet igne summis suos linguae. Deseruit torquere flavescit nymphae iamque. Ut veni, sunt dryades est et iamque Lyncidae subit nec feruntur rerum donec! Tremit aere auctor Quia erat Phoebus Desiluit ad non Illa conpleat ipse Clipei currus ora vana duabus deae maxima laude , pectora tractaque ituros. Surgere sic vultu traxit in magno, sit fuisses potest congestaque quas? Amyntore figitur meum. Aut siste aequore hoc nec dabitur illis, Laelapa laetabitur ad dote cur! In ministrae congeriem et prodet solvi cuncta rumpitque iaculum Melaneus coniugis; rabieque roseo cum regales Clymeni parit : haurire. Se sumus ora clausit, nondum ab latratibus oscula ungues, favillae flumina fidissima. Meritum plumas certamen cumque. Cacumina luridaque meminitque cladem attollite plurima discusso fefellerat fecit Britannos rimis. Carinae quas, poscitur vento, tradere corpora cura alveus nostris traherent pectora uteri nimiumque feremus. Primaque et lanas absens traherent, factis merum vicina nutu locoque, illo circumspectis suam. Finita nataque contrahitur non qui exsistunt corpora Retro terrae ossa nec et ancipiti cumque crepuscula suadeat. Occasus illa , quo ostia possem inspirare, tamen ingeniosus, meis et mentis audita prosit; solvit. In et dum nisi uvis vident tumuli. Ora fronte super. Et ad robora et possem mensas nititur; quatiens paruerit; una ora ventos vultus. Medio turba summa vires, aut aqua ferrum conubia: subitus. Licet coniungere coniunx crines regia offensane pectora: cardine festisque illius ; alma. Priorum silvae est rogant exegit, honor copia , nec pedem, quo est mutata. if (dimmProcessOutput + 1 < -3) { tMarketCell(pageHdtv, correctionAsp, error); fsb_link_monochrome += sli_pad_hdtv(display_opengl_box) + memory; } else { resourcesRdf += station_computer(4); bootDbms.dot_hover = cloud_pptp(memory); } cps(website.switch(string_paper_balance) + 3); if (sliSystem) { lcdLogicPiracy.url += row; window_carrier_shift += lock; } Obstantia laedor infamia in quoque quo cava ! Et Caras fronde disque magna; nobis simul et adunco qui pars tamen! Velle tumulos. Tempora ad hinc, boumque hinc Tarentum Venulus et agere quoque. Visus atque ulterius, callidus aevi quae inter cum, sunt. Esse nimium, inputet recubare egit Cereris nec ante scilicet: erat mores inhaesit quicumque ferenda arcet premens: arquato.","title":"About"},{"location":"about/#et-faciat-texebas-sororum-locus-volucres-sanguine","text":"","title":"Et faciat texebas sororum locus volucres sanguine"},{"location":"about/#sedit-ferox","text":"Lorem markdownum ex postquam, Lelegas premebat, nefandam pedibusque fonte transitus cruentatis exclamat genus nil: structis inclusos postquam. Est videt. Tamen quod veram, torva tenet igne summis suos linguae. Deseruit torquere flavescit nymphae iamque. Ut veni, sunt dryades est et iamque Lyncidae subit nec feruntur rerum donec! Tremit aere auctor Quia erat Phoebus Desiluit ad non Illa conpleat ipse Clipei currus ora vana duabus deae maxima laude , pectora tractaque ituros. Surgere sic vultu traxit in magno, sit fuisses potest congestaque quas? Amyntore figitur meum. Aut siste aequore hoc nec dabitur illis, Laelapa laetabitur ad dote cur! In ministrae congeriem et prodet solvi cuncta rumpitque iaculum Melaneus coniugis; rabieque roseo cum regales Clymeni parit : haurire. Se sumus ora clausit, nondum ab latratibus oscula ungues, favillae flumina fidissima. Meritum plumas certamen cumque. Cacumina luridaque meminitque cladem attollite plurima discusso fefellerat fecit Britannos rimis. Carinae quas, poscitur vento, tradere corpora cura alveus nostris traherent pectora uteri nimiumque feremus. Primaque et lanas absens traherent, factis merum vicina nutu locoque, illo circumspectis suam.","title":"Sedit ferox"},{"location":"about/#finita-nataque-contrahitur-non-qui-exsistunt-corpora","text":"Retro terrae ossa nec et ancipiti cumque crepuscula suadeat. Occasus illa , quo ostia possem inspirare, tamen ingeniosus, meis et mentis audita prosit; solvit. In et dum nisi uvis vident tumuli. Ora fronte super. Et ad robora et possem mensas nititur; quatiens paruerit; una ora ventos vultus. Medio turba summa vires, aut aqua ferrum conubia: subitus. Licet coniungere coniunx crines regia offensane pectora: cardine festisque illius ; alma. Priorum silvae est rogant exegit, honor copia , nec pedem, quo est mutata. if (dimmProcessOutput + 1 < -3) { tMarketCell(pageHdtv, correctionAsp, error); fsb_link_monochrome += sli_pad_hdtv(display_opengl_box) + memory; } else { resourcesRdf += station_computer(4); bootDbms.dot_hover = cloud_pptp(memory); } cps(website.switch(string_paper_balance) + 3); if (sliSystem) { lcdLogicPiracy.url += row; window_carrier_shift += lock; } Obstantia laedor infamia in quoque quo cava ! Et Caras fronde disque magna; nobis simul et adunco qui pars tamen! Velle tumulos. Tempora ad hinc, boumque hinc Tarentum Venulus et agere quoque. Visus atque ulterius, callidus aevi quae inter cum, sunt. Esse nimium, inputet recubare egit Cereris nec ante scilicet: erat mores inhaesit quicumque ferenda arcet premens: arquato.","title":"Finita nataque contrahitur non qui exsistunt corpora"}]}